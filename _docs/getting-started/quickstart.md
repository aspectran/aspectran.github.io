---
layout: page
format: article
title: "Quick Start"
subheadline: "Getting Started"
teaser: "본 문서는 Aspectran의 특징을 파악할 수 있도록 아주 간단한 사용법을 예를 들어서 설명합니다."
article_heading: true
breadcrumb: true
sidebar: toc
---

## 1. Aspectran Configuration

***Aspectran***이 구동되기 위해서는 구조화된 설정 메타데이터를 필요로 합니다.  
설정 메타데이터는 전통적인 XML 형식 또는 APON 형식의 파일로 작성해야 하며, 계층적으로 모듈화되어 여러 개의 파일로 나뉠 수 있습니다.

***Aspectran***을 대표하는 3개의 핵심 구성요소는 다음과 같습니다.

* ***aspect*** - Bean과 Translet이 가진 원래의 기능에 다른 부가 기능을 주입하는 방법을 정의합니다.  
관점지향프로그래밍(AOP)을 지원하기 위한 핵심 요소입니다.
* ***bean*** - IoC, DI의 대상이 되고, 기능을 가진 객체를 정의합니다.  
객체를 인스턴스화 하는 방법, 객체의 생명주기, 객체의 속성 값, 객체의 의존관계를 설정할 수 있습니다.
* ***translet*** - 요청 URI와 맵핑되어 비지니스 로직을 가지고 있는 Action Method를 호출하는 방법 및 응답 컨텐츠를 출력하는 방법을 정의합니다.

3개의 핵심 구성요소를 이용해서 "Hello, World." 문자열을 출력하는 "Aspectran Configuration XML 파일을 다음과 같이 간단하게 작성하였습니다.

***simplest-configuration.xml***

{% highlight xml %}
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE aspectran PUBLIC "-//aspectran.com//DTD Aspectran 1.0//EN"
                           "http://aspectran.github.io/dtd/aspectran-1.0.dtd">

<aspectran>

  <description>
      가장 간단한 Aspectran Configuration입니다.
  </description>

  <!-- 기본 설정 -->
  <settings>
      <setting name="transletNamePattern" value="/example/simplest/*"/>
  </settings>

  <bean id="simplestAction" class="com.aspectran.example.simplest.SimplestAction" scope="singleton">
      <description>
          Action Method를 가지고 있는 singleton Scope를 가지는 Bean을 정의합니다.
      </description>
  </bean>

  <bean id="simplestAdvice" class="com.aspectran.example.simplest.SimplestAdvice" scope="singleton">
      <description>
          Translet이나 Bean의 Method 실행 전 후에 주입할 Advice Action Method를 가지고 있는
          singleton Scope를 가지는 Bean을 정의합니다.
      </description>
  </bean>

  <aspect id="simplestAdvice">
      <description>
          "/example/simplest/"로 시작하고,
          simplestAction Bean의 helloWorld Method를 실행하는 Translet이 발견되면,
          해당 Translet의 실행 전에는 simplestAdvice Bean의 wellcome Method를 실행하고,
          해당 Translet의 실행 후에는 simplestAdvice Bean의 goodbye Method를 실행합니다.
      </description>
      <joinpoint scope="translet">
          <pointcut>
              target: {
                +: "/example/simplest/*@simplestAction^helloWorld"
              }
          </pointcut>
      </joinpoint>
      <advice bean="simplestAdvice">
          <before>
              <action method="wellcome"/>
          </before>
          <after>
              <action method="goodbye"/>
          </after>
      </advice>
  </aspect>

  <translet name="helloWorld">
      <description>
          simplestAction 빈에서 helloWorld Method를 실행해서 "Hello, World."라는 문구를
          텍스트 형식의 컨텐츠로 응답합니다.
      </description>
      <transform type="transform/text" contentType="text/plain">
          <action bean="simplestAction" method="helloWorld"/>
      </transform>
  </translet>

</aspectran>
{% endhighlight %}

## 2. Bean 작성하기

***SimplestAction.java***

{% highlight java %}
package com.aspectran.example.simplest;

import com.aspectran.core.util.logging.Log;
import com.aspectran.core.util.logging.LogFactory;

public class SimplestAction {

	private final Log log = LogFactory.getLog(SimplestAction.class);

	public String helloWorld() {
		String msg = "Hello, World.";

		log.info("The message generated by my first aciton is: " + msg);

		return msg;
	}

}
{% endhighlight %}

***SimplestAdvice.java***

{% highlight java %}
package com.aspectran.example.simplest;

import javax.servlet.http.HttpServletRequest;

import com.aspectran.core.activity.Translet;
import com.aspectran.core.util.logging.Log;
import com.aspectran.core.util.logging.LogFactory;

public class SimplestAdvice {

	private final Log log = LogFactory.getLog(SimplestAdvice.class);

	public String wellcome(Translet translet) {
		HttpServletRequest req = translet.getRequestAdaptee();
		String ip = req.getRemoteAddr();
		String msg = "Welcome to Aspectran! (" + ip + ")";

		log.info(msg);

		return msg;
	}

	public String goodbye() {
		String msg = "Goodbye!";

		log.info(msg);

		return msg;
	}

}
{% endhighlight %}

## 3. 실행

`helloWorld` Translet을 실행하기 위해 웹브라우저에서 다음 URL로 접근을 합니다.

* http://localhost:8080/example/simplest/helloWorld

다음과 같은 결과 화면이 출력됩니다.
![실행 결과 화면]({{ site.baseurl}}/images/quickstart/quickstart-result1.png)

***전체 실행 과정을 요약하면 다음 순서와 같습니다.***

<div class="panel radius" markdown="1">
1. 요청 URI가 `/example/simplest/helloWorld`인 요청이 들어오면 요청 URI와 맵핑된 Translet이 요청을 건네받습니다.
2. Translet이 내부의 `simplestAction` Bean의 `helloWorld` Method를 실행하려고 하지만, Proxy Method입니다.
3. `simplestAction` Bean의 `helloWorld` Proxy Method는 자신이 실행되려면 먼저 Aspect 규칙을 처리해야 한다는 것을 Translet에게 통보합니다.
4. 먼저 `simplestAdvice` Bean의 `wellcome` Method가 실행되면서 Console에 로그를 출력합니다.
5. Translet 내부의 `simplestAction` Bean의 `helloWorld` Method가 실행됩니다.
6. Translet은 실행 결과 값을 집계하여 `plain/text` 형식의 컨텐츠로 출력을 합니다.
7. `simplestAdvice` Bean의 `goodbye` Method가 실행되면서 Console에 로그를 출력합니다.
</div>

***Console에 기록된 로그***

{% highlight text linenos %}
DEBUG translet {name=/example/simplest/helloWorld, requestRule={method=null, characterEncoding=null}, responseRule={name=null, characterEncoding=null, response=com.aspectran.core.activity.response.transform.TextTransform@5506e8ba} } ~com.aspectran.core.activity.CoreActivity^ready:144
DEBUG action {qualifiedActionId=null, actionType=bean, beanActionRule={id=null, bean=simplestAction, method=helloWorld, hidden=null}} ~com.aspectran.core.activity.CoreActivity^execute:611
DEBUG register AspectRule {id=simplestAdvice, for=translet, joinpointScope=translet, pointcutRule={pointcutType=null}, settingsAdviceRule=null, aspectAdviceRuleList=[{aspectId=simplestAdvice, aspectAdviceType=before, action={qualifiedActionId=null, actionType=bean, beanActionRule={id=null, bean=null, method=wellcome, hidden=null}}}, {aspectId=simplestAdvice, aspectAdviceType=after, action={qualifiedActionId=null, actionType=bean, beanActionRule={id=null, bean=null, method=goodbye, hidden=null}}}], exceptionHandlingRule=null, onlyTransletRelevanted=false} ~com.aspectran.core.activity.CoreActivity^registerAspectRule:822
INFO  Welcome to Aspectran! (127.0.0.1) ~com.aspectran.example.simplest.SimplestAdvice^wellcome:18
INFO  The message generated by my first aciton is: Hello, World. ~com.aspectran.example.simplest.SimplestAction^helloWorld:13
DEBUG response {transformType=transform/text, contentType=text/plain, characterEncoding=null, templateRule=null} ~com.aspectran.core.activity.response.transform.TextTransform^response:84
INFO  Goodbye! ~com.aspectran.example.simplest.SimplestAdvice^goodbye:26
{% endhighlight %}
